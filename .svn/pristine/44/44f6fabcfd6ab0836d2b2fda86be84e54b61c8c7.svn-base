/**
* upload
* @version 0.6.8
* @namespace FOCUS.widget
* @author lvxiang
*/
window.FOCUS=window.FOCUS||{};
void function(k,m,p){this.UUID=(new Date).valueOf().toString(16).toUpperCase();this.namespace=function(){for(var c=[].slice.call(arguments),g,h,b,a=[];c.length;){g=c.shift().split(/\./);for(b=k;g.length;)h=g.shift(),b[h]||(b[h]={}),b=b[h];a.push(b)}return 1<a.length?a:a[0]};this.BASEPATH=k.FOCUS_BASEPATH||function(c){for(var g=k.location,h=/^(\w+\:\/{2,3}.+?)\//.exec(g.href)[1],b=/(.*?\/)(?:[^\/]*?(?:base|upload|transmitter)[^\/]*?)\.js(?:[?#].*)?$/i,a=/^\w+\:\/\//,d=/^\//,e=/^.*\//,f,l,n=0,u=c.length;n<
u;n++)if(l=c[n].src,a.test(l)||(l=d.test(l)?h+l:e.exec(g.href)[0]+l),l=b.exec(l)){f=l[1];break}f?(f=f.replace(RegExp(g.protocol+"\\/\\/"+g.host,"i"),""),f=g.protocol+"//"+g.host+f):f=e.exec(g.href)[0];return f}(m.getElementsByTagName("script"))}.call(FOCUS,this,this.document);
void function(k,m,p){var c=this.namespace("FOCUS.util");c.type=function(b){var a,d=/\{\s*\[native\s*code\]\s*\}/i;null===b?a="null":"undefined"===typeof b?a="undefined":(a=Object.prototype.toString.call(b).match(/\w+/g)[1].toLowerCase(),"object"===a&&d.test(b+"")&&(a="function"));return a};c.trim=function(b){return(b+"").replace(/^[\s\u00A0]+|[\s\u00A0]+$/g,"")};c.JSON=function(b){var a={};a.stringify=b?b.stringify:function(){return""};a.parse=function(a){var b;if("string"===c.type(a))try{b=(new Function("return "+
a))()}catch(f){b={}}else b=a;return b};return a}.call(this,k.JSON);c.browser=function(b){var a=/chrome\/(\d+\.\d+)/,d=/safari\/(\d+\.\d+)/,e=/version\/(\d+\.\d+)/,f={},l;if(l=/msie\s*(\d+\.\d+)/.exec(b))return f.msie=!0,f.version=l[1],f;if(l=/firefox\/(\d+\.\d+)/.exec(b))return f.mozilla=f.firefox=!0,f.version=l[1],f;if(l=/webkit\/(\d+\.\d+)/.exec(b)){f.webkit=!0;f.version=l[1];if(k.chrome)return f.chrome=!0,f.version=a.exec(b)[1],f;if(l=d.exec(b))f.safari=!0,f.version=[1];return f}if((l=/opera/.exec(b))&&
k.opera)f.opera=!0,f.version=e.exec(b)[1];return f}.call(this,k.navigator.userAgent.toLowerCase());c.flash=function(b,a){var d={has:!1,version:0};if(a.length&&a["Shockwave Flash"])a["Shockwave Flash"].description&&!("undefined"!==typeof b.mimeTypes&&b.mimeTypes["application/x-shockwave-flash"]&&!b.mimeTypes["application/x-shockwave-flash"].enabledPlugin)&&(d={has:!0,version:/\d+\.\d+/.exec(a["Shockwave Flash"].description)[0]});else if(k.ActiveXObject){var e,f=/\d+/g;try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(l){}e&&
(f.exec(""),d={has:!0,version:e.GetVariable("$version").match(f).join(".")})}return d}.call(this,k.navigator,k.navigator.plugins);c.extend=function(){var b=arguments.callee,a,d;"object"!==c.type(arguments[0])?(a=1,d=!!arguments[0]):(a=0,d=!1);var e=arguments[a]||{};a=[].slice.call(arguments,a+1);for(var f,l;a.length;)if(f=a.shift(),"object"===c.type(f)){var n,g;for(g in f)if(n=f[g],"object"===c.type(n))if(n==k||n==m||"childNodes"in n&&"nextSibling"in n&&"nodeType"in n){if(d||!(g in e))e[e]=n}else{l=
c.type(e[g]);if(!(g in e)||"undefined"===l||"null"===l)e[g]={};"object"===c.type(e[g])&&b(d,e[g],n)}else if(d||!(g in e))e[g]=n}return e};c.console=function(b){var a=!1,d=function(){},e={ON:!0,OFF:!1},d={SWITCH:e,turn:function(f){a=e[f?"ON":"OFF"]},log:d,info:d,warn:d,error:d,debug:d};if(!b)return d;b.debug||(b.debug=b.log);b.error||(b.error=b.warn);return c.extend(!0,d,{log:function(f){a===e.ON&&b.log(f)},info:function(f){a===e.ON&&b.info(f)},warn:function(f){a===e.ON&&b.warn(f)},error:function(f){a===
e.ON&&b.error(f)},debug:function(f){a===e.ON&&b.debug(f)}})}.call(k,k.console);c.indexOf=function(b,a){if(b.indexOf)return b.indexOf(a);for(var d=-1,e=0,f=b.length;e<f;e++)if(b[e]===a){d=e;break}return d};c.unique=function(b){for(var a=[],d=0,e=b.length;d<e;d++)-1===c.indexOf(a,b[d])&&a.push(b[d]);return a};c.random=function(){var b={};return function(a,d,e){a=a||0;d="number"===c.type(d)&&!isNaN(d)?d===a?d+10:d:a+10;var f=a+"_"+d;b[f]||(b[f]=[]);b[f].length===d-a&&(b[f]=[],"function"===c.type(e)&&
e.call(this));for(var l;;)if(l=a+~~(Math.random()*(d-a)),-1===c.indexOf(b[f],l)){b[f].push(l);break}return l}}.call(this);c.createElement=function(){return function(b){var a={};c.extend(!0,a,b);b="textarea"===a.el.toLowerCase();var d,e=c.extend(!0,{},a),f=["<",e.el],l=e.el;delete e.el;for(d in e)f.push(" ",d,'="',e[d],'"');f.push(-1===",meta,base,link,img,input,br,hr,area,sharp,".indexOf(","+l+",")?"></"+l+">":" />");d=f.join("");var n,e=!1;try{n=m.createElement(d)}catch(g){e=!0,n=m.createElement(a.el),
delete a.el}if(e)for(var h in a)n[h]=a[h];b&&(n.value=a.value);"input"===n.tagName.toLowerCase()&&(n.type=a.type?a.type:"text");return n}}.call(this);c.event=function(){var b=function(a){return a?function(a,b,d){a.addEventListener(b,d,!1)}:function(a,b,d){a.attachEvent("on"+b,d)}}.call(this,!!k.addEventListener);(function(a){return a?function(a,b,d){a.removeEventListener(b,d)}:function(a,b,d){a.detachEvent("on"+b,d)}}).call(this,!!k.removeEventListener);var a="FOCUS_EVENTS_"+(new Date).valueOf(),
d=function(a,f){for(var b=0,d=f.length;b<d;b++)f[b].handler.apply(this,[a].concat(f[b].params))};return{bind:function(e,f,l){e[a]||(e[a]={});var c=e[a];c[f]||(c[f]=[],b(e,f,function(a){a=a||k.event;d.call(e,a,c[f])}));c[f].push({handler:l,params:[].slice.call(arguments,3)})},remove:function(b,f,d){if(b[a]&&!(b[a]&&!b[a][f]||b[a]&&!b[a][f].length))if(b=b[a][f],d){f=-1;for(var c=0,g=b.length;c<g;c++)if(b[c].handler===d){f=c;break}d=f;-1!=d&&b.splice(d,1)}}}}.call(this);c.feature_upload=function(b){var a=
function(){var a=c.flash,d=a.has;if(a&&a.has&&b.oscpu&&c.browser.firefox&&4<=c.browser.version&&13>=c.browser.version){var e=/windows\s*nt\s*([\d\.]+)/i.exec(b.oscpu);if(e&&(/^6\.0/.test(e[1])||/^6\.1/.test(e[1]))&&/^11\.3/.test(a.version))d=!1}return d}.call(this),d=function(){if(c.browser.firefox&&3.6>c.browser.version)return!1;var a={},b=m.createElement("input");b.type="file";b.style.cssText="position:absolute; top:-999px; height:-999px;";m.body.appendChild(b);a.file=!!b.files;a.multiple="multiple"in
b&&!(c.browser.apple&&6>c.browser.version);m.body.removeChild(b);delete b;if(!k.XMLHttpRequest)return!1;b=new XMLHttpRequest;a.upload=!!b.upload;a.sendAsBinary=!!b.sendAsBinary;a.FormData=!!k.FormData&&!k.FormData.customized;delete b;return a}.call(this),e=function(){var a={};a.sameDomain=m.domain===(k.location.host||k.location.hostname);return a}.call(this);return{html5:d,flash:a,iframe:e}}.call(this,k.navigator);c.sizeConvert=function(){var b={KB:1024,MB:1048576,GB:1073741824},a=function(a,b){this.size=
a;this.unit=b};a.prototype={toString:function(){return this.size+" "+this.unit},valueOf:function(){return this.size}};var d=/^((?:\d+)(?:\.\d+)?)\s*([A-Za-z]*)$/g,e=/([A-Za-z]+)$/;return{unit2Bytes:function(a){var c=0;e.test(a)?(d.exec(""),(a=d.exec(a))&&(c=(parseFloat(a[1])||0)*(a[2]?b[a[2].toUpperCase()]:1024))):c=parseInt(a)||0;return c||0},bytes2Unit:function(f,d){var e=0,c=["GB","MB","KB"];d=d||"";if(!d)for(var g=0;g<c.length;g++)if(f>b[c[g]]){d=c[g];break}d&&(e=f/b[d]);return e=new a(e||0,d)}}}.call(this);
!k.FormData&&c.feature_upload.html5.sendAsBinary&&(k.FormData=function(b){this.charset=b||"UTF-8";this.reset()},k.FormData.prototype={append:function(b,a){var d="",e=this.EOL,f="--"+this.boundary,l=c.type(a);"object"===l&&(a=JSON.stringify(a),l="string");d=d+(f+e)+"Content-Disposition: form-data; ";"file"===l?(d+='name="'+this.encode(b)+'"; ',d+='filename="'+this.encode(a.filename||a.name)+'"'+e,d+="Content-Type: "+(a.type?a.type:"application/octet-stream")+e+e,d+=a.getAsBinary()+e):(d+='name="'+
this.encode(b)+'"'+e+e,d+=this.encode(a)+e);this.data+=d},getData:function(){return this.data+"--"+this.boundary+"--"+this.EOL},valueOf:function(){return this.getData()},toString:function(){return this.getData()},reset:function(){this.data="";this.boundary="---------------------------71"+(new Date).valueOf().toString(16).replace(/^0x/,"");this.EOL="\r\n"},encode:function(b){return c.transformCharset?c.transformCharset(b,this.charset):encodeURI(b)}},k.FormData.customized=!0);var g={"*/*":"*.*","image/*":"*.jpg; *.jpeg; *.jpe; *.png; *.gif",
"image/png":"*.png","image/jpeg":"*.jpg; *.jpeg; *.jpe","image/jpg":"*.jpg; *.jpeg; *.jpe","image/gif":"*.gif","image/bmp":"*.bmp","application/gzip":"*.gz","application/zip":"*.zip","application/vnd.ms-excel":"*.xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"*.xlsx","application/msword":"*.doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"*.docx","application/vnd.ms-powerpoint":"*.ppt","application/vnd.openxmlformats-officedocument.presentationml.presentation":"*.pptx",
"application/mshelp":"*.hlp; *.chm","application/pdf":"*.pdf","application/mp3":"*.mp3","text/html":"*.html; *.htm; *.xhtml","text/javascript":"*.js","text/css":"*.css","text/plain":"*.txt","default":"*.*"},h=function(b){var a=["image/*","image/jpg","default"],d={},e;for(e in b)-1===c.indexOf(a,e)&&b[e].replace(/[^\;\u0020]+/g,function(a){d[a]=e});return d}(g);c.convert2MimeTypes=function(b){b=b.split(/[\;\,]\s*/);var a=[],d="";if(b.length){for(var e=/^[^\/]+\/[^\/]+$/,f=0;f<b.length;f++)if(e.test(b[f]))a.push(b[f]);
else if(b[f]in h&&"*.*"!==b[f])a.push(h[b[f]]);else{d="*/*";break}d||(d=c.unique(a).join(", "))}else d="*/*";return d};c.convertMimeTypes=function(b){b=b.split(/[\;\,]\s*/);var a=[],d="";if(b.length){for(var e=/^[^\\\/]+\.[^\\\/]+$/,f=0;f<b.length;f++)if(e.test(b[f]))a.push(b[f]);else if(b[f]in g&&"*/*"!==b[f])a.push(g[b[f]]);else{d="*.*";break}d||(d=c.unique(a).join("; "))}else d="*.*";return d};c.mimeValidation=function(b,a){if(-1!==(b+"").indexOf("*/*"))return!0;a+="";"string"===c.type(b)&&(b=
b.split(/[\;\,\s]+/));var d=!1,e=/^([^\/]+)\/([^\/]+)$/,f=e.exec(a),l;if(!f)return!1;for(var g=0;g<b.length;g++)if(l=e.exec(b[g]),b[g]===a||l[1]===f[1]&&("*"===l[2]||l[2]===f[2])){d=!0;break}return d};c.addClass=function(b,a){var d=c.trim(b.className).split(/\s+/);d.push(a);b.className=c.unique(d).join(" ")};c.removeClass=function(b,a){var d=c.unique(c.trim(b.className).split(/\s+/)),e=c.indexOf(d,a);-1!==e&&d.splice(e,1);b.className=d.join(" ")}}.call(FOCUS,this,this.document);
void function(k,m,p){this.namespace("FOCUS.widget");var c=this.util,g=this.widget,h=function(){},b=function(){var a=c.feature_upload;return{flash:a.flash,html5:a.html5&&a.html5.upload&&(a.html5.sendAsBinary||a.html5.FormData),iframe:!0}}.call(this),a=g.Upload=function(b){this.cfg={priority:a.PRIORITY.DEFAULT,events:{ready:h,loadFailed:h,dialogStart:h,dialogComplete:h,queued:h,queueError:h,uploadStart:h,uploadProgress:h,uploadSuccess:h,uploadError:h,uploadComplete:h},button:{text:"Upload"},multiple:!0,
sizeLimit:-1,uploadLimit:-1,queueLimit:-1,fileTypes:a.MIME_TYPE.ALL,uploadURL:"",filePostName:"",placeholder:"#uploader",debug:!1,plugins:"UploadEvents,AutoDisabled,Ready,Patch4Charset",fileTypesDescription:"All Files"};this.set(b);a.plugins.UploadEvents&&(this.uploadEvents=new a.plugins.UploadEvents(this.cfg.events),this.set({events:this.uploadEvents.events}));this._={};this.init();return this.instance};a.prototype={init:function(){for(var d=this,e=this.cfg.priority,f,l=0;l<e.length;l++)if(b[e[l]]){f=
e[l];break}e={html5:"Upload_HTML5",flash:"Upload_Flash",iframe:"Upload_Iframe"};if(f){if(f===a.MODE.FLASH){for(var h in this.cfg.events)this.cfg.events[h]=function(b,f){var d=a.File4Flash;return function(a){a&&a.id?b.apply(this,[new d(a)].concat([].slice.call(arguments,1))):b.apply(this,[].slice.call(arguments,0))}}.call(this,this.cfg.events[h],h);this.cfg.fileTypes=c.convertMimeTypes(this.cfg.fileTypes);this.cfg.events.ready=function(a){return function(){setTimeout(function(){a.call(d.instance,f)},
25)}}(this.cfg.events.ready)}else this.cfg.fileTypes=c.convert2MimeTypes(this.cfg.fileTypes);this.instance=new g[e[f]](this.cfg);f!==a.MODE.FLASH&&setTimeout(function(){d.cfg.events.ready.call(d.instance,f)},25);h=a.plugins;h.UploadEvents&&(this.uploadEvents.bindThisObj(this.instance),"on,one,off,fire".replace(/(\w+)/g,function(a){d.instance[a]=function(){d.uploadEvents[a].apply(d.uploadEvents,arguments);return d.instance}}));for(var k in h)k.replace(/([\$\^\[\]\\/\,\?\:\|\{\}\!\(\)\*\-\+])/g,"\\$1"),
"UploadEvents"!==k&&RegExp("(^|,)"+k+"(,|$)").exec(this.cfg.plugins)&&h[k].call(this.instance,this.instance.mode)}else throw"not support this constructor.";},set:function(a){var b=this.cfg.plugins;a&&(a.plugins&&"string"===c.type(a.plugins))&&(b+=","+a.plugins,b=c.unique(b.split(/[,;\s]+/)).join(","));c.extend(!0,this.cfg,a);this.cfg.plugins=b}}}.call(FOCUS,this,this.document);
void function(k,m,p){var c=this.widget.Upload,g=this.util;k=c.MODE={HTML5:"html5",FLASH:"flash",IFRAME:"iframe",DEFAULT:"html5"};c.PRIORITY={DEFAULT:[k.HTML5,k.FLASH,k.IFRAME]};c.MIME_TYPE={ALL:"*/*",IMAGE:"image/*",JPG:"image/jpeg",JPEG:"image/jpeg",PNG:"image/png",GIF:"image/gif",PDF:"application/pdf",DOC:"application/msword",DOCX:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",XLS:"application/vnd.ms-excel",XLSX:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
PPT:"application/vnd.ms-powerpoint",PPTX:"application/vnd.openxmlformats-officedocument.presentationml.presentation",TXT:"text/plain",UNKNOWN:"application/octet-stream"};c.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130,CHAIN_ERROR:-140};c.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,
UPLOAD_STOPPED:-290,RESIZE:-300,TIMEOUT:-310};c.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5,NEW:-6};c.UPLOAD_TYPE={SINGLE:1,MULTI:2};c.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120,JAVASCRIPT:-130,NONE:-130};c.CURSOR={POINTER:-2,DEFAULT:-1};c.CSS={WRAP:"FOCUS_UPLOAD_wrap",SELECTOR:"FOCUS_UPLOAD_selector",FLASH:"FOCUS_UPLOAD_flashWrap",TEXT:"FOCUS_UPLOAD_text",DISABLED:"FOCUS_UPLOAD_wrap_disabled",HOVER:"FOCUS_UPLOAD_wrap_hover"};c.CHARSET={UTF8:"UTF-8",
GBK:"GBK",GB2312:"GB2312",BIG5:"BIG5",DEFAULT:"UTF-8"};c.TURNING={ON:!0,OFF:!1};var h=function(b,a){a=a||{};var d=b.split(/\./);a.suffix=1<d.length?d.pop():"";a.name=d.join(".");return a};c.File=function(b){var a={data:b};a.id="FOCUS_UPLOAD_"+(g.random(0,1E6)+~~((new Date).valueOf()/1E7)).toString(16).toUpperCase();if(b.tagName&&"input"===b.tagName.toLowerCase()&&"file"===b.type){if(b=/[^\/\\]+$/.exec(b.value))a.fullname=b[0],h(a.fullname,a)}else a.size=b.filesize||b.size||0,a.type=b.type||"",a.fullname=
b.filename||b.name||"",h(a.fullname,a);a.type=a.suffix?a.suffix.toUpperCase()in c.MIME_TYPE?c.MIME_TYPE[a.suffix.toUpperCase()]:"":"";a.status=c.FILE_STATUS.NEW;return a};c.File4Flash=function(b){this.data=b;this.id=b.id;this.size=b.size;this.status=b.filestatus;this.suffix=b.type.replace(/^\./,"");this.type=c.MIME_TYPE[this.suffix.toUpperCase()];this.fullname=b.name;b=this.fullname.split(/\./);1<b.length&&b.pop();this.name=b.join(".")}}.call(FOCUS,this,this.document);
void function(k,m){FOCUS.namespace("FOCUS.widget");var p=function(){},c=this.util,g=this.widget,h=g.Upload,b=h.CSS,a=h.MODE,d=h.UPLOAD_ERROR,e=h.FILE_STATUS;g.UploadBase=function(){};g.UploadBase.prototype={init:p,set:function(a){this.cfg=c.extend(!0,this.cfg,a)},debug:function(a){c.log.turn(!!a)},startUpload:p,getFile:p,cancelUpload:function(a){var b=this.getQueueFile();if(b){b.status=e.CANCELLED;if("function"===c.type(a))this.one("uploadError",a);this.cfg.events.uploadError.call(this,b,d.FILE_CANCELLED,
"file cancelled.");this.elems.poster&&this.elems.poster.abort()}},stopUpload:function(a){var b=this.getQueueFile();if(b){b.status=e.QUEUED;if("function"===c.type(a))this.one("uploadError",a);this.cfg.events.uploadError.call(this,b,d.UPLOAD_STOPPED,"upload stopped.");this.elems.poster&&this.elems.poster.abort();this._.queue.unshift(b)}},getQueueFile:function(a){a=a||0;var b=c.type(a),d=this._.queue,e=null;if("number"===b)a<=d.length-1&&(e=d[a]);else if("string"===b)for(b=0;b<d.length;b++)if(d[b].id===
a){e=d[b];break}return e},setPostParam:function(a){this.cfg.postParams||(this.cfg.postParams={});c.extend(!0,this.cfg.postParams,a)},addPostParam:function(a,b){this.cfg.postParams||(this.cfg.postParams={});this.cfg.postParams[a]=b},removePostParam:function(a){!this.cfg.postParams||!a?this.cfg.postParams={}:a in this.cfg.postParams&&delete this.cfg.postParams[a]},setUploadURL:function(a){this.cfg.uploadURL=a+""},setFilePostName:function(a){this.cfg.filePostName=a+""},setFileTypes:function(b){switch(this.mode){case a.IFRAME:case a.HTML5:this.cfg.fileTypes=
this.elems.selector.accept=c.convert2MimeTypes(b)}},setFileSizeLimit:function(a){this.cfg.sizeLimit=a},setFileQueueLimit:function(a){this.cfg.queueLimit=a;this.elems.selector.multiple=1!==a},__setStyle:function(a,d,e,g){d.className=b.WRAP;c.browser.firefox&&(e.size=6);e.className=b.SELECTOR;a=d.getElementsByTagName("label");a.length&&d.removeChild(a[0]);a=m.createElement("label");a.className=b.TEXT;a.innerHTML=g;d.insertBefore(a,e);c.event.bind(d,"mouseover",function(a){a.cancelBubble=!0;a.returnValue=
!1;c.addClass(d,b.HOVER)});c.event.bind(d,"mouseout",function(a){a.cancelBubble=!0;a.returnValue=!1;c.removeClass(d,b.HOVER)})},__translateStatus:function(a){var b=c.type(a);"string"===b?(a=c.trim(a),a=a.length?!!h.TURNING[a.toUpperCase()]:h.TURNING.OFF):a="undefined"===b?!this._.status:!!a;return a},turn:function(a){a=this.__translateStatus(a);a!==this._.status&&(this.elems.selector.disabled=!a,this._.status=a,c[a?"removeClass":"addClass"](this.elems.holder,b.DISABLED))},multiple:function(a){this.elems.selector.multiple=
!!a},queue:function(){},dequeue:function(b){if(this.mode===a.IFRAME||this.mode===a.HTML5)switch(c.type(b)){case "string":for(var d=0;d<this._.queue.length;d++)if(this._.queue[d].id===b){b=d;break}case "number":this._.queue.splice(b,1);break;case "boolean":b?this._.queue.splice(0):this._.queue.splice(0,1)}else if(this.mode===a.FLASH)switch(c.type(b)){case "string":case "number":this.instance.cancelUpload(b,!1);break;case "undefined":b=!1;case "boolean":if(b)for(;b=this.instance.getQueueFile();)this.instance.cancelUpload(b.file_id,
!1);else this.instance.cancelUpload(0,!1)}}}}.call(FOCUS,this,this.document);
void function(k,m){var p=this.namespace("FOCUS.widget.Upload.plugins"),c=this.util,g=this.widget.Upload.UPLOAD_ERROR,h=function(a,b){this.type=a;this.listeners=[];this._={thisObj:b}};h.prototype={__search:function(a,b){for(var e=-1,c=b||0;c<this.listeners.length;c++)if(this.listeners[c].handle===a){e=c;break}return e},add:function(a,b){var e=a.handles,f=a.thisObj||null,g=a.once||!1;b=[].slice.call(arguments,1);"function"===c.type(e)&&(e=[e]);if("array"===c.type(e))for(var h=0;h<e.length;h++)"function"===
c.type(e[h])&&this.listeners.push({handle:e[h],thisObj:f,once:!!g,args:b})},one:function(a,b){"object"===c.type(a)&&(a.once=!0,this.add(a,[].slice.call(arguments,1)))},remove:function(a){if(a){"function"===c.type(a)&&(a=[a]);for(var b,e=0;e<a.length;e++)"function"===c.type(a[e])&&-1!==(b=this.__search(a[e]))&&this.listeners.splice(b,1)}else this.listeners=[]},exec:function(a){for(var b,c=[],f=0;f<this.listeners.length;f++)b=this.listeners[f],b.once&&c.push(b.handle),b.handle.apply(b.thisObj||this._.thisObj||
this,[].concat.call(b.args,[].slice.call(arguments)));this.remove(c)},bindThisObj:function(a){this._.thisObj=a}};var b=function(a,b){this._={events:{},thisObj:b};this.events={};for(var c in a)this.on(c,a[c]),this.events[c]=function(a){var b=this;return"uploadError"===a?function(d,c,e){switch(c){case g.FILE_CANCELLED:b.fire.apply(b,["cancel",d,g.FILE_CANCELLED,"file cancelled."]);break;case g.UPLOAD_STOPPED:b.fire.apply(b,["stop",d,g.UPLOAD_STOPPED,"upload stopped."]);break;default:b.fire.apply(b,
[a].concat([].slice.call(arguments)))}}:function(){b.fire.apply(b,[a].concat([].slice.call(arguments)))}}.call(this,c)};b.prototype={__initEvent:function(a,b,c){a in this._.events||(this._.events[a]=new h(a,this._.thisObj));return{handles:b,thisObj:c}},on:function(a,b,c,f){var g=this.__initEvent(a,b,c);this._.events[a].add.apply(this._.events[a],[g].concat([].slice.call(arguments,3)))},off:function(a,b){a in this._.events&&this._.events[a].remove(b)},one:function(a,b,c,f){var g=this.__initEvent(a,
b,c);this._.events[a].one.apply(this._.events[a],[g].concat([].slice.call(arguments,3)))},fire:function(a,b){a in this._.events&&this._.events[a].exec.apply(this._.events[a],[].slice.call(arguments,1))},bindThisObj:function(a){this._.thisObj=a;for(var b in this._.events)this._.events[b].bindThisObj(a)}};p.UploadEvents=b}.call(FOCUS,window,window.document);
void function(){this.namespace("FOCUS.widget.Upload.plugins").AutoDisabled=function(k){this.on("uploadStart",function(){this.turn("off")}).on("uploadComplete",function(){this.turn("on")})}}.call(FOCUS);void function(){var k=this.util;this.widget.Upload.plugins.Ready=function(m){var p=!1,c=this,g=[],h=function(){for(;g.length;)g.shift().call(c,m)};this.on("ready",function(){this.isReady=p=!0;h()});this.ready=function(b){"function"===k.type(b)&&g.push(b);p&&h()}}}.call(FOCUS);
void function(k,m,p){k=this.namespace("FOCUS.widget.io.iframe");var c=this.util,g=c.createElement;m=function(){this.elems={}};m.prototype={_:{text:function(c,b){return g({el:"textarea",name:c,value:b+""})},radio:function(c,b,a){return g({el:"input",type:"radio",name:c,value:b,checked:!!a})},checkbox:function(c,b,a){return g({el:"input",type:"checkbox",name:c,value:b,checked:!!a})},file:function(h,b){if(h)return b&&b.name&&(h.name=b.name),h;var a={el:"input",type:"file"};c.extend(!0,a,b);return g(a)},
clone:function(c){return c.cloneNode(!0)}},append:function(g,b){var a=c.type(b),d;"string"!==a&&"file"===b.type?d=this._.file(b,{name:g}):"string"===a&&(d=this._.text(g,b+""));this.elems[g]=d}};k.IO_FormData=m}.call(FOCUS,window,document);
void function(k,m,p){p=this.namespace("FOCUS.widget.io.iframe");var c=function(){},g=this.util,h=g.createElement,b=function(a){this.cfg={events:{load:c,error:c},timeout:1E5,charset:"UTF-8"};g.extend(!0,this.cfg,a);this.elems={};this._={};this.init()};b.prototype={init:function(){var a=this;this.elems.io=h({el:"iframe",name:"FOCUS_UPLOAD_IO_"+g.random(0,1E3),src:g.browser.msie?"javascript:document.open();"+(m.domain===k.location.hostname?"":"document.domain='"+m.domain+"';")+"void(0)":"about:blank"});
this.elems.io.style.cssText="position:absolute; width:1px; height:1px; top: -9999px; left:-9999px;";m.body.appendChild(a.elems.io);setTimeout(function(){a.elems.win=a.elems.io.contentWindow;a.elems.doc=a.elems.io.contentWindow.document},25);this._.timer=-1;this._.handle={load:function(){if(a._.submited){clearTimeout(a._.timer);var b=a._.handle.getData(a.elems.io);"undefined"===g.type(b)?a.cfg.events.error.call(this,"IO_ERROR"):a.cfg.events.load.call(this,b);a._.submited=!1;setTimeout(function(){a._deleteForm()},
25)}},error:function(){a.cfg.events.error.call(this);a._.submited=!1},getData:function(a){var b;try{b=a.contentWindow.document.body.innerHTML.replace(/(^|)\<\/?pre[^\>]*\>(|$)/gi,"")}catch(c){}return b}};this.elems.io.attachEvent?this.elems.io.attachEvent("onload",this._.handle.load):this.elems.io.onload=this._.handle.load},open:function(a,b){this._.openCfg={method:"GET"===a.toUpperCase()?"GET":"POST",action:b}},send:function(a,b){var c=this;setTimeout(function(){var f={el:"form",name:"FOCUS_UPLOAD_FORM_"+
g.random(0,1E3),method:c._.openCfg.method,action:c._.openCfg.action||""};f.target=c.elems.io.name;var k=[],n=!1,p,s;for(s in a.elems)p=a.elems[s],"file"===p.type&&(n=!0),k.push(p);f.enctype=n?"multipart/form-data":"application/x-www-form-urlencoded";c._deleteForm();var v=c.elems.__submit_form=h(f);v.style.cssText="position:absolute; width:1px; height:1px; top: -9999px; left:-9999px;";for(m.body.appendChild(v);k.length;)v.appendChild(k.shift());b=b||c.cfg.charset||"UTF-8";var x;g.browser.msie&&(x=
m.charset);g.browser.msie?m.charset=b:v.acceptCharset=b;setTimeout(function(){c._.submited=!0;v.submit();setTimeout(function(){g.browser.msie&&(m.charset=x)},1)},25)},100)},onload:function(a){this.cfg.events.load=a},onerror:function(a){this.cfg.events.error=a},overrideGetData:function(a){this._.handle.getData=a},setUrl:function(a){this.elems.__submit_form.action=a},_deleteForm:function(){try{this.elems.__submit_form&&this.elems.__submit_form.parentNode.removeChild(this.elems.__submit_form)}catch(a){}delete this.elems.__submit_form},
_deleteIO:function(){try{this.elems.io&&(this.__removeOnloadEvent(),this.elems.io.parentNode.removeChild(this.elems.io))}catch(a){}delete this.elems.doc;delete this.elems.win;delete this.elems.io},dispose:function(){this._deleteForm();this._deleteIO()},__removeOnloadEvent:function(){this.elems.io&&(this.elems.io.detachEvent?this.elems.io.detachEvent("onload",this._.handle.load):this.elems.io.onload=c)}};p.IO_Iframe=b}.call(FOCUS,window,document);
void function(k,m,p){k=this.namespace("FOCUS.widget.io.iframe");var c=k.IO_FormData,g=k.IO_Iframe,h=this.util,b=function(){};m=function(a){this.cfg={events:{error:b,load:b,progress:b,abort:b},progressURL:"",charset:"UTF-8",timeout:1E5};this._={cancel:!1,timeout:!1,loaded:!1,timeoutTimer:-1};this.elems={};this.set(a);this.init()};m.prototype={init:function(){var a=this;this._.getProgress=function(){var b=arguments.callee;if(a.cfg.progressURL&&!a._.loaded){a.elems.io_progress=new g;a.elems.io_progress.onload(function(c){setTimeout(function(){a.elems.io_progress.dispose()},
25);a._.loaded||(c=h.JSON.parse(c),a.cfg.events.progress.call(c),setTimeout(function(){b()},100))});a.elems.io_progress.open("GET",a.cfg.progressURL,!0);var e=new c;e.append("progress","loaded");a.elems.io_progress.send(e)}}},send:function(a){if(!this._.cancel){var b=this;this._.timeoutTimer=setTimeout(function(){b.timeout()},this.cfg.timeout);this.elems.io.send(a,this.cfg.charset);setTimeout(function(){b._.cancel||b.cfg.events.progress.call(b,{loaded:0,total:100})},1);this._.getProgress()}},open:function(a,
b){this._.fullProgress=!1;this.reset();this.elems.io.open(a,b)},set:function(a){h.extend(!0,this.cfg,a)},reset:function(){var a=this;this.elems.io&&this.elems.io.dispose();this.elems.io_progress&&this.elems.io_progress.dispose();this.elems.io=new g({timeout:this.cfg.timeout});this.elems.io.onload(function(b){a._.timeout||(a._.fullProgress||(a.cfg.events.progress.call(a,{loaded:100,total:100}),a._.fullProgress=!0),clearTimeout(a._.timeoutTimer),a._.cancel||(a._.loaded=!0,a.cfg.events.load.call(a,b,
this)))});this.elems.io.onerror(function(b){clearTimeout(a._.timeoutTimer);a._.cancel||a.cfg.events.error.call(a,this,b)});this._.cancel=!1;this._.timeout=!1;this._.loaded=!1;this._.timeoutTimer=-1},dispose:function(){this.elems.io&&(this.elems.io.dispose(),delete this.elems.io);this.elems.io_progress&&(this.elems.io_progress.dispose(),delete this.elems.io_progress)},timeout:function(){this._.timeout=!0;this.elems.io.__removeOnloadEvent();this.cfg.events.error.call(this,this,"timeout")},abort:function(){this._.cancel=
!0;clearTimeout(this._.timeoutTimer);this.elems.io&&this.elems.io.__removeOnloadEvent();this.cfg.events.abort()}};k.Poster=m}.call(FOCUS,window,document);
void function(k,m,p){var c=function(){},g=this.util,h=this.widget,b=h.Upload,a=b.MODE,d=b.UPLOAD_ERROR,e=b.FILE_STATUS,f=b.QUEUE_ERROR,l=g.createElement,n=h.io.iframe,u=n.Poster,s=n.IO_FormData;h.Upload_Iframe=function(d){this.constructor=arguments.callee;this.mode=a.IFRAME;this.elems={};this.cfg={events:{ready:c,loadFailed:c,dialogStart:c,dialogComplete:c,queued:c,queueError:c,uploadStart:c,uploadProgress:c,uploadSuccess:c,uploadError:c,uploadComplete:c},button:{text:"Upload"},multiple:!0,sizeLimit:-1,
queueLimit:-1,fileTypes:b.MIME_TYPE.ALL,fileTypesDescription:"All Files",uploadURL:"",filePostName:"",placeholder:"#uploader",charset:b.CHARSET.DEFAULT,debug:!1,timeout:1E5};this._={queue:[],uploadingFile:null,uploadedFile:[],status:b.TURNING.ON};this.set(d);this.init()};h.Upload_Iframe.prototype=new FOCUS.widget.UploadBase;g.extend(!0,h.Upload_Iframe.prototype,{init:function(){var a=this;this.elems.holder=l({el:"div"});this.elems.holder.style.cssText="";var c={missing_url:[d.MISSING_UPLOAD_URL,"missing upload URL."],
invalid_filetype:[f.INVALID_FILETYPE,"File is not an allowed file type."],size_limit:[f.FILE_EXCEEDS_SIZE_LIMIT,"File size exceeds allowed limit."],chain_error:[f.CHAIN_ERROR,"Some reason to occured chain error."]};g.extend(this._,{open:function(b){var c=new s;if("object"===g.type(a.cfg.postParams))for(var d in a.cfg.postParams)c.append(d,a.cfg.postParams[d]);c.append(a.cfg.filePostName||b.id,b.data);a.elems.poster.open("POST",a.cfg.uploadURL,!0);return c},post:function(b){a.elems.poster.send(b)},
start:function(b){if(b=a.getQueueFile())!a.cfg.uploadURL||"string"!==g.type(a.cfg.uploadURL)?(a.cfg.events.uploadError.apply(a,[b].concat(c.missing_url)),a.stopUpload()):(b.status=e.IN_PROGRESS,a._.uploadingFile=b,a.cfg.events.uploadStart.call(a,b),b=a._.open(b),a._.post(b))},dialogStart:function(b){b=b||k.event;b.stopPropagation?b.stopPropagation():b.cancelBubble=!0;a.cfg.events.dialogStart.call(a)},__queued:function(d,h){var k=[],l=[],m=a._.queue,n=new b.File(this);if(this.files&&(!g.browser.firefox||
g.browser.firefox&&3.6<=g.browser.version)){var p=[],s=!1,r;if(-1!==a.cfg.queueLimit&&this.files.length+a._.queue.length>a.cfg.queueLimit){for(var q=0,t=this.files.length;q<t;q++)r=new b.File(this.files[q]),k.push(r),a.cfg.events.queueError.call(a,r,f.QUEUE_LIMIT_EXCEEDED,a.cfg.queueLimit);s=!0}else for(var u=g.sizeConvert.unit2Bytes(a.cfg.sizeLimit),q=0,t=this.files.length;q<t;q++){r=new b.File(this.files[q]);k.push(r);var w;if(g.mimeValidation(a.cfg.fileTypes,r.type)){if(-1!==u&&(r.fileSize||r.size)>
u)w=c.size_limit}else w=c.invalid_filetype;w?(a.cfg.events.queueError.apply(a,[r].concat(w)),s=!0):p.push(r)}if(s){q=0;for(t=p.length;q<t;q++)p[q].id=n.id,a.cfg.events.queueError.apply(a,[p[q]].concat(c.chain_error))}else{q=0;for(t=p.length;q<t;q++)p[q].status=e.QUEUED,p[q].id=n.id,a.cfg.events.queued.call(a,p[q]);l=l.concat(p);m.push(n)}delete p}else k.push(n),FOCUS.util.mimeValidation(a.cfg.fileTypes,n.type)?(l.push(n),m.push(n),n.status=e.QUEUED,a.cfg.events.queued.call(a,n)):a.cfg.events.queueError.apply(a,
[n].concat(c.invalid_filetype));d&&(a.elems.selector.parentNode.removeChild(a.elems.selector),a.elems.selector=a._._crateSelector(a.elems.holder,a._.dialogStart,a._.dialogComplete));"function"===FOCUS.util.type(h)&&h.call(a,k.length,l.length,m.length);delete k;delete l;delete m},dialogComplete:function(b){b=b||k.event;b.stopPropagation?b.stopPropagation():b.cancelBubble=!0;a._.__queued.call(this,!0,a.cfg.events.dialogComplete)},uploadProgress:function(b){var c=a.getQueueFile();c&&(c.status=e.IN_PROGRESS,
b.loaded===b.total&&(c.fullProgress=!0),a.cfg.events.uploadProgress.call(a,c,b.loaded,b.total))},uploadSuccess:function(b,c){var d=a.elems.poster,e=a.getQueueFile();e&&a.cfg.events.uploadSuccess.call(a,e,b,d)},uploadError:function(b,c){c=(c||"").toUpperCase();var f=a.getQueueFile();f&&(f.status=e.ERROR,a.cfg.events.uploadError.call(a,f,d[c?c:"UPLOAD_FAILED"],c?c:"TIMEOUT"),a._.uploadComplete(!0))},uploadComplete:function(b,c){var d=a.getQueueFile();d&&(!b&&(!d.fullProgress&&!c)&&(a._.uploadProgress.call(a,
{loaded:d.size,total:d.size}),d.fullProgress=!0),c||(d.status=e.COMPLETE),a._.queue.shift(),a._.uploadingFile=null,a.cfg.events.uploadComplete.call(a,d))},complete:function(b,c){a._.uploadSuccess.call(a,b,c);a._.uploadComplete.call(a);setTimeout(function(){a.elems.poster&&(a.elems.poster.dispose(),delete a.elems.poster)},25)},abort:function(){setTimeout(function(){a._.uploadComplete(!1,!0)},1)},_crateSelector:function(b,c,d){var e=l({el:"input",type:"file",name:"FOCUS_FILE_"+g.random(0,100),multiple:!!a.cfg.multiple});
b.appendChild(e);g.event.bind(e,"click",c);g.event.bind(e,"change",d);a.__setStyle("iframe",a.elems.holder,e,a.cfg.button.text);return e}});var h=g.query?g.query(this.cfg.placeholder):m.getElementById(this.cfg.placeholder.replace(/^#/,""));h&&("length"in h&&(h=h[0]),h&&(h.parentNode.insertBefore(this.elems.holder,h),a.elems.selector=this._._crateSelector(this.elems.holder,this._.dialogStart,this._.dialogComplete),h.parentNode.removeChild(h)))},startUpload:function(){this.elems.poster&&this.elems.poster.dispose();
this.elems.poster=new u({events:{abort:this._.abort,load:this._.complete,error:this._.uploadError,progress:this._.uploadProgress},progressURL:this.cfg.progressURL,charset:this.cfg.charset,timeout:this.cfg.timeout||1E5});this._.start()},queue:function(a,b){if(a){a.length===p&&(a=[a]);for(var c=0;c<a.length;c++)this._.__queued.call(a[c],!1,b)}}})}.call(FOCUS,this,this.document);
