/* Pub Time: September 16, 2013 16:34:24 */void function(){function i(){this._options()&&(this._.selectedOption=this._options().eq(this._.selectedIndex),this._options().removeClass(this.config.style.chooseCls),this._.selectedOption.addClass(this.config.style.chooseCls),this.elems.$menu.find("span").html((this._.options[this._.selectedIndex]?this._.options[this._.selectedIndex]:null)&&(this._.options[this._.selectedIndex]?this._.options[this._.selectedIndex]:null).name),this._.target.selectedIndex=this._.selectedIndex)}function k(a){var e,
b;e=0;for(b=this._.options.length;e<b;e++)if(a===this._.options[e].name)return e;return-1}function l(){if(this._.changeEvents.length)for(var a=0;this._.changeEvents[a];)this._.changeEvents[a]instanceof Function&&this._.changeEvents[a].call(this),a++}function m(a,e){var b,d,f,g;b=0;for(d=a.length;b<d;b++){f=document.createElement("dd");if(a[b].value instanceof Array){var c=document.createElement("dl");g=document.createElement("dt");!a[b].value.length&&a[b].type?(g.className=this.config.style.tagName+
"-"+a[b].type,c.appendChild(g)):(g.innerHTML=a[b].name,c.appendChild(g),c.className=this.config.style.optgroupCls,c.appendChild(arguments.callee.call(this,a[b].value,document.createDocumentFragment())));f.appendChild(c)}else f.className=this.config.style.optCls,f.innerHTML='<a href="javascript:;">'+a[b].name+"</a>";e.appendChild(f)}return e}function n(a,e){if(!a)return null;var b=a.childNodes,d,f;for(d=0;d<b.length;d++)b[d]&&1===b[d].nodeType&&("optgroup"===b[d].nodeName.toLowerCase()?(f={name:b[d].label,
value:arguments.callee(b[d],[])},b[d].getAttributeNode("data-type")&&(f.type=b[d].getAttributeNode("data-type").nodeValue)):f={name:b[d].text,value:b[d].value},e.push(f));return e}function h(a){return"."===a.substring(0,1)?a:"."+a}var j=new Abstract({onchange:function(){},selectedIndex:function(){},options:function(){},optgroups:function(){},disabled:function(){},unfold:function(){},value:function(){}}),j=new Clazz(j,{config:{carrier:null,trigger:"click",control:{dropRows:null},style:{tagName:"choice",
listCls:"choice-list",menuCls:"choice-hd",optCls:"choice-option",optgroupCls:"choice-optgroup",chooseCls:"selected",unfoldCls:"hover",unfoldReverseCls:"hover-reverse"}},inherit:Component},function(a){this.setConfig(a);a:{var a=Error(),e=this.config;try{a.name="selectInit";e.carrier||(a.message="Carrier must not be null.");if(!e.style.menuCls||!e.style.listCls||!e.style.optCls)a.message="Style structure insufficiency.";throw a;}catch(b){if(window.console&&b.message){console.log(b.message);a=null;break a}}a=
!0}if(a){this._.selectedIndex=0;this._.triggerEvent=this.config.trigger;this._.selectedOption=null;this._.optsWidth=null;this._.disabled=!1;this._.changeEvents=[];this._.showPos=this.config.style.unfoldCls;this.elems.$carrier=$(this.config.carrier);this.elems.$menu=this.elems.$carrier.find(h(this.config.style.menuCls));this.elems.$list=this.elems.$carrier.find(h(this.config.style.listCls));this._.target=this.elems.$carrier.find("select")[0];this._.data=n(this._.target,[]);var a=this._,e=this._.target.options,
d,f,g=[];d=0;for(f=e.length;d<f;d++)g.push({name:e[d].text,value:e[d].value});a.options=g;this.elems.$carrier.attr("data-trigger")&&(this._.triggerEvent=this.elems.$carrier.attr("data-trigger"));this.elems.$carrier.attr("data-width")&&(this._.optsWidth=this.elems.$carrier.attr("data-width"),this.elems.$list.css("width",this._.optsWidth));this.elems.$list.empty();this.elems.$list[0].appendChild(m.call(this,this._.data,document.createDocumentFragment()));i.call(this);this.config.control.dropRows&&this.config.control.dropRows<
this._.target.options.length+this._.target.getElementsByTagName("optgroup").length&&this.elems.$list.css({overflow:"auto",height:parseInt(this._.selectedOption.outerHeight())*this.config.control.dropRows});var c=this;"click"===this._.triggerEvent&&(this.elems.$menu.on(this._.triggerEvent,function(a){a.stopPropagation();c._unfold.call(c)}),$(document).on("click",function(a){a.stopPropagation();c.elems.$carrier.removeClass(c._.showPos)}));"mouseover"===this._.triggerEvent&&this.elems.$carrier.hover(function(){c._unfold.call(c)},
function(){c.elems.$carrier.removeClass(c._.showPos)});this.elems.$list.on("mouseover",function(){c.elems.$list.find(h(c.config.style.chooseCls)).removeClass(c.config.style.chooseCls)});this.elems.$list.on("click",function(a){var b=c._.selectedIndex;a.stopPropagation();if(a.target.nodeName.toLowerCase()==="a"){c._.selectedIndex=k.call(c,a.target.innerText);i.call(c);c.elems.$carrier.removeClass(c._.showPos);b!==c._.selectedIndex&&l.call(c)}});this.onchange.implement(this._onchange);this.selectedIndex.implement(this._selectedIndex);
this.disabled.implement(this._disabled);this.unfold.implement(this._unfold);this.options.implement(this._options);this.optgroups.implement(this._optgroups);this.value.implement(this._value)}});j.extend({_onchange:function(a){this._.changeEvents.push(a)},_selectedIndex:function(a){parseInt(a)>this._.options().length||(this._.selectedIndex=a,i.call(this))},_disabled:function(a){this._.disabled=a},_unfold:function(){if(!this._.disabled){var a;a=parseInt(this.elems.$carrier.offset().top)+parseInt(this.elems.$list.outerHeight())+
parseInt(this.elems.$menu.outerHeight())>$(window).height()+document.body.scrollTop?!0:!1;a?(this._.showPos=this.config.style.unfoldReverseCls,"none"!==this.elems.$list.css("display")&&this.elems.$carrier.addClass(this._.showPos),this.elems.$carrier.removeClass(this.config.style.unfoldCls)):(this._.showPos=this.config.style.unfoldCls,"none"!==this.elems.$list.css("display")&&this.elems.$carrier.addClass(this._.showPos),this.elems.$carrier.removeClass(this.config.style.unfoldReverseCls));this.elems.$carrier.toggleClass(this._.showPos);
i.call(this)}},_options:function(){return this.config.style.optCls?this.elems.$list.find(h(this.config.style.optCls)):null},_optgroups:function(){if(this.config.style.optgroupCls)return this.elems.$list.find(h(this.config.style.optgroupCls))},_value:function(){return this._.options[this._.selectedIndex].value}});window.MaskSelect=j}.call(window);
